<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PBS Finance | Verify Access</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicons/favicon-16x16.png">

  <!-- vendor CSS (your existing files) -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/main.css">
  <link rel="stylesheet" href="assets/css/pbs-app.css">

  <style>
    /* Small scoped styles to keep page visually in-line with your auth pages */
    body { background: linear-gradient(180deg,#f5f7f9 0%, #eef4f6 100%); }
    .auth-section { display:flex; align-items:center; min-height:100vh; padding:40px 0; }
    .auth-card { max-width:520px; margin:0 auto; background:#fff; border-radius:14px; padding:32px; box-shadow: 0 18px 40px rgba(10,20,25,0.08); }
    .auth-logo img { display:block; margin:0 auto 14px; }
    .auth-title { text-align:center; font-size:1.4rem; margin-bottom:6px; color:#112; font-weight:700; }
    .auth-subtitle { text-align:center; color:#58616a; margin-bottom:18px; }
    .twofa-options { display:flex; gap:12px; margin:18px 0 10px; }
    .twofa-card { flex:1; padding:12px 14px; border-radius:10px; border:1px solid #e6eef0; cursor:pointer; display:flex; align-items:center; gap:12px; transition: all .15s ease; background:#fbfdfe; }
    .twofa-card.selected { border-color:#b5e480; box-shadow: 0 6px 18px rgba(181,228,128,0.12); background: linear-gradient(90deg, rgba(181,228,128,0.07), #fbfdfe); }
    .twofa-card .icon { width:42px;height:42px;border-radius:10px;background:#eef6f3;display:flex;align-items:center;justify-content:center;font-size:18px;color:#0f2b2b; }
    .twofa-note { color:#63717a; font-size:.95rem; margin-bottom:12px; }
    .cta-row { display:flex; gap:10px; margin-top:14px; }
    .auth-btn-full { width:100%; padding:12px 18px; border-radius:999px; font-weight:700; background:#b5e480; color:#072; border:none; box-shadow:none; }
    .secondary-btn { background:transparent; border:1px solid #e3eef0; padding:10px 12px; border-radius:999px; color:#31424a; }
    .code-entry { display:flex; gap:8px; margin-top:14px; justify-content:center; }
    .code-entry input { width:56px; height:56px; text-align:center; font-size:20px; border-radius:8px; border:1px solid #dbe7ea; }
    .small-muted { color:#7b858c; font-size:.9rem; }
    .resend { color:#083b3b; font-weight:700; cursor:pointer; text-decoration:underline; }
    .success-box { display:none; padding:18px; background:#e8fbeb; border-radius:10px; color:#0b6630; font-weight:700; margin-top:12px; }
    @media (max-width:576px){ .twofa-options { flex-direction:column; } .code-entry { justify-content:space-between; } }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <section class="auth-section">
      <div class="container">
        <div class="auth-card">

          <!-- LOGO -->
          <div class="auth-logo">
            <img src="assets/images/logo-dark.png" alt="PBS" width="140">
          </div>

          <h1 class="auth-title">Verify Access</h1>
          <p class="auth-subtitle">Choose how you'd like to receive a verification code</p>

          <!-- Info showing masked contact details (UI-only). In real flow these would be populated server-side -->
          <p class="twofa-note small-muted">We will send a one-time verification code to the contact you provided during registration.</p>

          <div class="twofa-options" role="list">
            <div class="twofa-card selected" role="listitem" id="opt-sms" data-method="sms" tabindex="0" aria-pressed="true">
              <div class="icon">üì©</div>
              <div>
                <div style="font-weight:700;">SMS</div>
                <div class="small-muted" id="sms-dest">+27 82 ‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢12</div>
              </div>
            </div>

            <div class="twofa-card" role="listitem" id="opt-email" data-method="email" tabindex="0" aria-pressed="false">
              <div class="icon">‚úâÔ∏è</div>
              <div>
                <div style="font-weight:700;">Email</div>
                <div class="small-muted" id="email-dest">s‚Ä¢‚Ä¢‚Ä¢@example.co.za</div>
              </div>
            </div>
          </div>

          <div class="twofa-note">Select a delivery method and press <strong>Send Code</strong>. This is a UI prototype ‚Äî sending is simulated.</div>

          <div class="cta-row">
            <button id="send-code-btn" class="auth-btn-full">Send Code</button>
            <button id="change-details" class="secondary-btn">Change details</button>
          </div>

          <!-- Code entry area (hidden until Send pressed) -->
          <div id="code-panel" style="display:none; margin-top:18px;">
            <p class="small-muted">Enter the 6-digit code you received.</p>

            <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
              <div class="code-entry" aria-label="Enter verification code">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 1">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 2">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 3">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 4">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 5">
                <input inputmode="numeric" pattern="[0-9]*" maxlength="1" class="code-digit" aria-label="Digit 6">
              </div>

              <div style="flex:1; min-width:180px;">
                <button id="verify-btn" class="auth-btn-full" style="width:100%;">Verify</button>
                <div style="margin-top:8px; display:flex; justify-content:space-between; align-items:center;">
                  <div class="small-muted">Didn't get it?</div>
                  <div><span id="resend-link" class="resend">Resend</span></div>
                </div>
                <div style="margin-top:8px;" class="small-muted">Time remaining: <span id="countdown">02:00</span></div>
              </div>
            </div>

            <div class="success-box" id="success-box">Verification successful ‚Äî access granted. Redirecting...</div>
          </div>

          <div style="margin-top:12px;" class="auth-footer-text small-muted">
            If you didn't register for an account, <a href="index.html" class="auth-link">return to home</a>.
          </div>

        </div>
      </div>
    </section>
  </div>

  <!-- simple UI-only script -->
  <script>
    (function(){
      // Simulated masked data - in real integration these values would be injected
      var maskedPhone = '+27 82 ‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢12';
      var maskedEmail = 's‚Ä¢‚Ä¢‚Ä¢@example.co.za';
      document.getElementById('sms-dest').textContent = maskedPhone;
      document.getElementById('email-dest').textContent = maskedEmail;

      var selectedMethod = 'sms';
      var optSms = document.getElementById('opt-sms');
      var optEmail = document.getElementById('opt-email');

      function selectCard(el) {
        // manage aria-pressed for accessibility
        [optSms, optEmail].forEach(function(card){
          card.classList.remove('selected');
          card.setAttribute('aria-pressed', 'false');
        });
        el.classList.add('selected');
        el.setAttribute('aria-pressed', 'true');
        selectedMethod = el.getAttribute('data-method');
      }

      optSms.addEventListener('click', function(){ selectCard(optSms); });
      optEmail.addEventListener('click', function(){ selectCard(optEmail); });
      // allow keyboard select
      optSms.addEventListener('keydown', function(e){ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); selectCard(optSms);} });
      optEmail.addEventListener('keydown', function(e){ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); selectCard(optEmail);} });

      var sendBtn = document.getElementById('send-code-btn');
      var codePanel = document.getElementById('code-panel');
      var verifyBtn = document.getElementById('verify-btn');
      var successBox = document.getElementById('success-box');
      var resendLink = document.getElementById('resend-link');
      var changeDetails = document.getElementById('change-details');

      // small countdown helper
      var countdownEl = document.getElementById('countdown');
      var countdownTimer = null;
      function startCountdown(seconds) {
        clearInterval(countdownTimer);
        var remaining = seconds;
        function update() {
          var mm = String(Math.floor(remaining/60)).padStart(2,'0');
          var ss = String(remaining % 60).padStart(2,'0');
          countdownEl.textContent = mm + ':' + ss;
          if (remaining <= 0) {
            clearInterval(countdownTimer);
            // enable resend
            resendLink.style.opacity = 1;
            resendLink.style.pointerEvents = 'auto';
          }
          remaining--;
        }
        update();
        countdownTimer = setInterval(update, 1000);
        // initially disable resend
        resendLink.style.pointerEvents = 'none';
        resendLink.style.opacity = 0.5;
      }

      // focus behaviour for code inputs
      function setupCodeInputs(){
        var inputs = document.querySelectorAll('.code-digit');
        inputs.forEach(function(inp, idx){
          inp.value = '';
          inp.addEventListener('input', function(e){
            var v = inp.value.replace(/\D/g,'').slice(0,1);
            inp.value = v;
            if (v && idx < inputs.length - 1) inputs[idx+1].focus();
          });
          inp.addEventListener('keydown', function(e){
            if(e.key === 'Backspace' && !inp.value && idx>0){
              inputs[idx-1].focus();
            }
          });
        });
      }
      setupCodeInputs();

      // Simulated "send code" behaviour
      sendBtn.addEventListener('click', function(){
        // show the code panel
        codePanel.style.display = 'block';
        // clear code inputs, hide success
        document.querySelectorAll('.code-digit').forEach(i=>i.value='');
        successBox.style.display = 'none';

        // small toast (could become a UI hint)
        sendBtn.textContent = 'Code Sent';
        setTimeout(()=> sendBtn.textContent = 'Send Code', 1500);

        // start countdown 2 minutes
        startCountdown(120);

        // simulate autofocus on first digit (delayed so UI renders)
        setTimeout(()=> {
          var first = document.querySelector('.code-digit');
          if(first) first.focus();
        }, 150);
      });

      resendLink.addEventListener('click', function(){
        // simulate resend
        resendLink.textContent = 'Resent ‚úì';
        setTimeout(()=> resendLink.textContent = 'Resend', 1400);
        // reset countdown
        startCountdown(120);
      });

      verifyBtn.addEventListener('click', function(){
        // collect code digits
        var code = Array.from(document.querySelectorAll('.code-digit')).map(i=>i.value || '').join('');
        if (code.length < 6) {
          // simple validation hint
          alert('Enter the 6-digit code that was sent to your ' + (selectedMethod==='sms' ? 'phone.' : 'email.'));
          return;
        }

        // simulate verification success
        successBox.style.display = 'block';
        successBox.textContent = 'Verification successful ‚Äî redirecting to admin portal...';

        // after short delay redirect to admin dashboard (UI-only)
        setTimeout(function(){
          window.location.href = 'admin-dashboard.html';
        }, 1100);
      });

      // change details simply returns to registration page (UI-only)
      changeDetails.addEventListener('click', function(e){
        e.preventDefault();
        window.location.href = 'admin-registration.html'; // ensure this filename matches your registration page
      });

      // preselect SMS by default
      selectCard(optSms);
    })();
  </script>

  <script src="assets/js/jquery-3.5.1.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
</body>
</html>
